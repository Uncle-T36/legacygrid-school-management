{% extends 'base.html' %}

{% block title %}Schools Directory - LegacyGrid School Management{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="h2 mb-0">
                        <i class="bi bi-building me-3"></i>Schools Directory
                    </h1>
                    <p class="text-muted">Manage and monitor all educational institutions</p>
                </div>
                <button class="btn btn-lg-primary" data-bs-toggle="modal" data-bs-target="#addSchoolModal">
                    <i class="bi bi-plus-lg me-2"></i>Add New School
                </button>
            </div>
        </div>
    </div>

    <!-- Search and Filter Bar -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="bi bi-search"></i>
                                </span>
                                <input type="text" class="form-control" placeholder="Search schools..." id="schoolSearch">
                            </div>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="typeFilter">
                                <option value="">All Types</option>
                                <option value="primary">Primary</option>
                                <option value="secondary">Secondary</option>
                                <option value="combined">Combined</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="statusFilter">
                                <option value="">All Status</option>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="provinceFilter">
                                <option value="">All Provinces</option>
                                <option value="harare">Harare</option>
                                <option value="bulawayo">Bulawayo</option>
                                <option value="manicaland">Manicaland</option>
                                <option value="mashonaland">Mashonaland</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <button class="btn btn-outline-secondary w-100" id="resetFilters">
                                <i class="bi bi-arrow-clockwise me-1"></i>Reset
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Schools Grid -->
    <div class="row" id="schoolsGrid">
        <!-- Sample School Cards - These would be dynamically generated from database -->
        
        <!-- Primary School Example -->
        <div class="col-lg-4 col-md-6 mb-4 school-card" data-type="primary" data-status="active" data-province="harare">
            <div class="card feature-card h-100">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span class="badge bg-primary">Primary School</span>
                    <span class="badge bg-success">Active</span>
                </div>
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="me-3">
                            <div class="bg-primary bg-opacity-10 rounded-circle p-3">
                                <i class="bi bi-building text-primary fs-4"></i>
                            </div>
                        </div>
                        <div>
                            <h5 class="card-title mb-1">Harare Primary School</h5>
                            <small class="text-muted">
                                <i class="bi bi-geo-alt me-1"></i>Harare, Zimbabwe
                            </small>
                        </div>
                    </div>
                    
                    <div class="row text-center mb-3">
                        <div class="col-4">
                            <div class="border-end">
                                <h6 class="fw-bold text-primary mb-0">450</h6>
                                <small class="text-muted">Students</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="border-end">
                                <h6 class="fw-bold text-success mb-0">24</h6>
                                <small class="text-muted">Teachers</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <h6 class="fw-bold text-warning mb-0">7</h6>
                            <small class="text-muted">Grades</small>
                        </div>
                    </div>
                    
                    <p class="card-text text-muted small">
                        Established institution providing quality primary education with modern facilities and experienced faculty.
                    </p>
                </div>
                <div class="card-footer bg-transparent">
                    <div class="d-flex gap-2">
                        <a href="{% url 'school_profile' %}" class="btn btn-outline-primary btn-sm flex-fill">
                            <i class="bi bi-eye me-1"></i>View
                        </a>
                        <button class="btn btn-outline-secondary btn-sm flex-fill">
                            <i class="bi bi-pencil me-1"></i>Edit
                        </button>
                        <button class="btn btn-outline-info btn-sm flex-fill">
                            <i class="bi bi-graph-up me-1"></i>Stats
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Secondary School Example -->
        <div class="col-lg-4 col-md-6 mb-4 school-card" data-type="secondary" data-status="active" data-province="bulawayo">
            <div class="card feature-card h-100">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span class="badge bg-success">Secondary School</span>
                    <span class="badge bg-success">Active</span>
                </div>
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="me-3">
                            <div class="bg-success bg-opacity-10 rounded-circle p-3">
                                <i class="bi bi-mortarboard text-success fs-4"></i>
                            </div>
                        </div>
                        <div>
                            <h5 class="card-title mb-1">Mufakose High School</h5>
                            <small class="text-muted">
                                <i class="bi bi-geo-alt me-1"></i>Bulawayo, Zimbabwe
                            </small>
                        </div>
                    </div>
                    
                    <div class="row text-center mb-3">
                        <div class="col-4">
                            <div class="border-end">
                                <h6 class="fw-bold text-primary mb-0">680</h6>
                                <small class="text-muted">Students</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="border-end">
                                <h6 class="fw-bold text-success mb-0">45</h6>
                                <small class="text-muted">Teachers</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <h6 class="fw-bold text-warning mb-0">6</h6>
                            <small class="text-muted">Forms</small>
                        </div>
                    </div>
                    
                    <p class="card-text text-muted small">
                        Leading secondary education institution with excellent academic performance and comprehensive curriculum.
                    </p>
                </div>
                <div class="card-footer bg-transparent">
                    <div class="d-flex gap-2">
                        <a href="{% url 'school_profile' %}" class="btn btn-outline-primary btn-sm flex-fill">
                            <i class="bi bi-eye me-1"></i>View
                        </a>
                        <button class="btn btn-outline-secondary btn-sm flex-fill">
                            <i class="bi bi-pencil me-1"></i>Edit
                        </button>
                        <button class="btn btn-outline-info btn-sm flex-fill">
                            <i class="bi bi-graph-up me-1"></i>Stats
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Combined School Example -->
        <div class="col-lg-4 col-md-6 mb-4 school-card" data-type="combined" data-status="active" data-province="manicaland">
            <div class="card feature-card h-100">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span class="badge bg-info">Combined School</span>
                    <span class="badge bg-success">Active</span>
                </div>
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="me-3">
                            <div class="bg-info bg-opacity-10 rounded-circle p-3">
                                <i class="bi bi-collection text-info fs-4"></i>
                            </div>
                        </div>
                        <div>
                            <h5 class="card-title mb-1">Mutare Combined School</h5>
                            <small class="text-muted">
                                <i class="bi bi-geo-alt me-1"></i>Manicaland, Zimbabwe
                            </small>
                        </div>
                    </div>
                    
                    <div class="row text-center mb-3">
                        <div class="col-4">
                            <div class="border-end">
                                <h6 class="fw-bold text-primary mb-0">320</h6>
                                <small class="text-muted">Students</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="border-end">
                                <h6 class="fw-bold text-success mb-0">28</h6>
                                <small class="text-muted">Teachers</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <h6 class="fw-bold text-warning mb-0">13</h6>
                            <small class="text-muted">Classes</small>
                        </div>
                    </div>
                    
                    <p class="card-text text-muted small">
                        Comprehensive education from Grade 1 to Form 6 with modern facilities and dedicated staff.
                    </p>
                </div>
                <div class="card-footer bg-transparent">
                    <div class="d-flex gap-2">
                        <a href="{% url 'school_profile' %}" class="btn btn-outline-primary btn-sm flex-fill">
                            <i class="bi bi-eye me-1"></i>View
                        </a>
                        <button class="btn btn-outline-secondary btn-sm flex-fill">
                            <i class="bi bi-pencil me-1"></i>Edit
                        </button>
                        <button class="btn btn-outline-info btn-sm flex-fill">
                            <i class="bi bi-graph-up me-1"></i>Stats
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add more school cards as needed -->
        <!-- No Schools Found Message -->
        <div class="col-12 d-none" id="noSchoolsMessage">
            <div class="text-center py-5">
                <i class="bi bi-building display-1 text-muted mb-3"></i>
                <h3 class="text-muted">No schools found</h3>
                <p class="text-muted">Try adjusting your search criteria or add a new school.</p>
                <button class="btn btn-lg-primary" data-bs-toggle="modal" data-bs-target="#addSchoolModal">
                    <i class="bi bi-plus-lg me-2"></i>Add New School
                </button>
            </div>
        </div>
    </div>

    <!-- Load More Button -->
    <div class="row mt-4">
        <div class="col-12 text-center">
            <button class="btn btn-outline-primary btn-lg" id="loadMoreBtn">
                <i class="bi bi-arrow-down me-2"></i>Load More Schools
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('schoolSearch');
    const typeFilter = document.getElementById('typeFilter');
    const statusFilter = document.getElementById('statusFilter');
    const provinceFilter = document.getElementById('provinceFilter');
    const resetButton = document.getElementById('resetFilters');
    const schoolCards = document.querySelectorAll('.school-card');
    const noSchoolsMessage = document.getElementById('noSchoolsMessage');
    const loadMoreBtn = document.getElementById('loadMoreBtn');

    // Filter function
    function filterSchools() {
        const searchTerm = searchInput.value.toLowerCase();
        const typeValue = typeFilter.value;
        const statusValue = statusFilter.value;
        const provinceValue = provinceFilter.value;
        
        let visibleCount = 0;

        schoolCards.forEach(card => {
            const schoolName = card.querySelector('.card-title').textContent.toLowerCase();
            const cardType = card.dataset.type;
            const cardStatus = card.dataset.status;
            const cardProvince = card.dataset.province;

            const matchesSearch = schoolName.includes(searchTerm);
            const matchesType = !typeValue || cardType === typeValue;
            const matchesStatus = !statusValue || cardStatus === statusValue;
            const matchesProvince = !provinceValue || cardProvince === provinceValue;

            if (matchesSearch && matchesType && matchesStatus && matchesProvince) {
                card.style.display = 'block';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        // Show/hide no results message
        if (visibleCount === 0) {
            noSchoolsMessage.classList.remove('d-none');
        } else {
            noSchoolsMessage.classList.add('d-none');
        }
    }

    // Event listeners for filtering
    searchInput.addEventListener('input', filterSchools);
    typeFilter.addEventListener('change', filterSchools);
    statusFilter.addEventListener('change', filterSchools);
    provinceFilter.addEventListener('change', filterSchools);

    // Reset filters
    resetButton.addEventListener('click', function() {
        searchInput.value = '';
        typeFilter.value = '';
        statusFilter.value = '';
        provinceFilter.value = '';
        filterSchools();
    });

    // Load more functionality
    loadMoreBtn.addEventListener('click', function() {
        // Placeholder for load more functionality
        alert('Load more functionality will be implemented when connected to the database!');
    });

    // Initialize tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
});
</script>
{% endblock %}